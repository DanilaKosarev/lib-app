# Library

Многопользовательская система учета книг с функциями администратора. Пользователи могут бронировать книги и оставлять обзоры на них.

## Используемые технологии 

- Java
- Maven
- Spring Boot, Spring Web, Spring Security, Spring Scheduler, Spring Mail
- PostgreSQL, Spring Data JPA
- Liquibase - автоматическое создание таблиц БД, их заполнение начальными данными
- JWT - аутентификация и авторизация пользователей
- Docker - контейнеры, образы, volumes, написание Dockerfile, Docker Compose
- Брокер сообщений Kafka
- JUnit 5, AssertJ, Mockito - тестирование
- Swagger - документация

Проект реализован с использованием микросервисного подхода и включает в себя 3 микросервиса:

### Backend (library)

Spring Boot приложение, реализующее REST API для входа в систему, работы с пользователями, книгами и обзорами на книги.

Работа с пользователями:

- Регистрация
- Авторизация
- Получение данных о пользователе
- Изменение данных пользователя
- Изменения статуса пользователя (user или admin)
- Удаление пользователя

Работа с книгами:

- Добавление новой книги в систему
- Получение данных о книге
- Изменение данных существующей книги
- Возможность взять или вернуть книгу
- Удаление книги

Работа с обзорами:

- Добавление нового обзора для книги (обзор состоит из оценки и комментария)
- Получение данных обзора
- Изменение данных в существующем обзоре
- Удаление обзора

Имеет написанные тесты для одного из сервисов.
### Сервис уведомлений (notification-service)

Spring Boot приложение с модулем Spring Scheduler. 

Задача сервиса - раз в сутки искать книги, которые находятся у пользователей больше допустимого срока (книга может быть взята пользователем не более, чем на 10 дней).

Информация о найденных книгах и их владельцах передается в Kafka. 

### Сервис отправки писем (email-sender)

Spring Boot приложение с модулем Spring Mail.

Сервис подключается к Kafka и принимает сообщения, получаемые от бэкенд-сервиса (для отправки приветственного письма после регистрации пользователя) и сервиса уведомлений (для отправки письма о том, что пользователю необходимо вернуть книгу). 

На основании десериализованного содержимого каждого сообщения, формируется соответствующее письмо, отправляемое с помощью Spring Mail на электронный адрес пользователя.

## Инструкция по запуску проекта на локальном компьютере

- Установить Docker на локальную машину
- Склонировать текущий репозиторий
- В .env файл поместить свои данные для настройки отправки сообщений по протоколу SMTP. Можно использовать SMTP-сервис Яндекса https://yandex.ru/support/mail/mail-clients/others.html#smtpsetting

```bash
# Образец сконфигурированного .env файла
HOST=smtp.yandex.ru
PORT=465
EMAIL=username@yandex.ru
PASSWORD=qwerty
```
- Запустить приложение

```bash
docker-compose up
```
- Страница с документацией будет доступна по ссылке: http://localhost:8080/swagger-ui/index.html
- В приложении сразу доступна учетная запись администратора с логином "admin@mail.com" и паролем "password"
